[{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"linktree","dir":"Articles","previous_headings":"","what":"linktree","title":"linktree","text":"goal linktree estimate group transmission assortativity coefficient. Details method published .","code":""},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"installation","dir":"Articles","previous_headings":"linktree","what":"Installation","title":"linktree","text":"","code":"# install.packages(\"pak\") pak::pak(\"CyGei/linktree\") library(linktree)"},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"transmission-assortativity","dir":"Articles","previous_headings":"linktree","what":"Transmission assortativity","title":"linktree","text":"Group transmission assortativity quantifies tendency individuals transmit within group relative groups. defined relative increase, decrease, probability within-group transmission compared expected random transmission. Random transmission expectations calculated based group’s relative size, defined proportion total susceptible population belongs group. metric characterises transmission patterns, reflecting contact patterns group-specific differences susceptibility infectiousness.","code":""},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"gamma","dir":"Articles","previous_headings":"linktree > Transmission assortativity","what":"Gamma","title":"linktree","text":"γ\\gamma ranges 00 ∞\\infty, : γA=1\\gamma_A = 1 represents homogeneous (random) transmission: Individuals group equally likely transmit groups. γA\\gamma_A >1 indicates assortative transmission: Individuals group likely transmit groups. γA<1\\gamma_A < 1 indicates disassortative transmission: Individuals group less likely transmit groups. example, γA=2\\gamma_A = 2, individuals group twice likely transmit within group compared groups. Conversely, γA=1/2\\gamma_A = 1/2, individuals group half likely transmit within group compared groups.","code":""},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"delta","dir":"Articles","previous_headings":"linktree > Transmission assortativity","what":"Delta","title":"linktree","text":"simplify interpretation, introduce rescaled parameter δ\\delta, ranging −1-1 (fully disassortative) 11 (fully assortative), 0 indicating homogeneous patterns.  can visualise relationship γ\\gamma δ\\delta:","code":"delta <- seq(-1, 1, 0.1) gamma <- delta2gamma(delta) plot(gamma, delta, type = \"l\") points(1, 0, col = \"red\", pch = 16)  # Homogeneous"},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"estimation","dir":"Articles","previous_headings":"linktree > Transmission assortativity","what":"Estimation","title":"linktree","text":"get_gamma get_delta estimate γ\\gamma δ\\delta transmission tree. requires following inputs: : vector infector’s group (e.g. age group, sex, vaccination status, etc.). : vector infectee’s group. f: named vector groups’ sizes relative sizes (.e. proportion susceptible population group).","code":""},{"path":[]},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"data","dir":"Articles","previous_headings":"linktree > Example","what":"Data","title":"linktree","text":"can simulate outbreak multiple groups using o2groups package use linktree estimate assortativity coefficients transmission tree. pre-loaded simulated transmission tree, see ?sim_tree details.","code":"#?sim_tree true_gammas <- c(HCW = 2, patient = 1/1.25) sizes <- c(HCW = 100, patient = 350) # data(sim_tree)  sim_tree <- read.csv(\"https://raw.githubusercontent.com/CyGei/linktree/refs/heads/main/vignettes/sim_tree.csv\") head(sim_tree) #>     group     id source source_group date_infection date_onset #> 1     HCW HmPsw2   <NA>         <NA>              0         12 #> 2 patient WtYSxS   <NA>         <NA>              0         12 #> 3 patient gZ6tF2   <NA>         <NA>              0          3 #> 4 patient Kxtgdz   <NA>         <NA>              0          1 #> 5 patient aH9xtg gZ6tF2      patient              1          5 #> 6     HCW DJE8PP gZ6tF2      patient              2          5"},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"visualise-the-transmission-tree","dir":"Articles","previous_headings":"linktree > Example","what":"Visualise the transmission tree","title":"linktree","text":"","code":"library(epicontacts)  x <- epicontacts::make_epicontacts(   linelist = sim_tree[, c(\"group\", \"id\", \"date_infection\", \"date_onset\")],   contacts = sim_tree[, c(\"source\", \"id\", \"source_group\", \"group\")],   id = \"id\",   from = \"source\",   to = \"id\",   directed = TRUE )  plot(x,     method = \"visNetwork\",     label = FALSE,     node_color = \"group\",      node_shape = \"group\",     shapes = c(patient = \"bed\", HCW = \"user-md\"),     edge_color = \"source_group\",     edge_width = 1,     node_size = 20,     col_pal = epicontacts::spectral,     edge_col_pal = epicontacts::spectral   )"},{"path":"https://cygei.github.io/linktree/articles/linktree.html","id":"estimate-the-transmission-assortativity-coefficient","dir":"Articles","previous_headings":"linktree > Example","what":"Estimate the transmission assortativity coefficient","title":"linktree","text":"published paper provides guidelines circumstances can reliably infer group transmission assortativity. Notably, analyse transmission chains group’s epidemic peak avoid saturation effect, least ~30 cases group.  example, estimate patients 1.25 times less likely transmit patients, HCWs 1.34 times likely transmit HCWs (although none statistically significant).","code":"est_delta <- get_delta(   from = sim_tree$source_group,   to = sim_tree$group,   f = sizes, ) true_deltas <- gamma2delta(true_gammas)  plot(est_delta, main = \"Estimated vs True assortativity coefficients\") abline(h = true_deltas, col = c(\"#d53e4f\", \"#3288bd\"), lty = 2) legend(\"topright\", legend = c(\"HCW (truth)\", \"patient (truth)\"), fill = c(\"#d53e4f\", \"#3288bd\"), bty = \"n\")"},{"path":"https://cygei.github.io/linktree/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Cyril Geismar. Author, maintainer, copyright holder.","code":""},{"path":"https://cygei.github.io/linktree/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Geismar C (2025). linktree: Estimate Transmission Assortativity Coefficients. R package version 0.1.0, https://github.com/CyGei/linktree.","code":"@Manual{,   title = {linktree: Estimate Transmission Assortativity Coefficients},   author = {Cyril Geismar},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/CyGei/linktree}, }"},{"path":"https://cygei.github.io/linktree/index.html","id":"linktree-","dir":"","previous_headings":"","what":"Estimate Transmission Assortativity Coefficients","title":"Estimate Transmission Assortativity Coefficients","text":"linktree novel framework estimates group transmission assortativity transmission trees.","code":""},{"path":"https://cygei.github.io/linktree/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimate Transmission Assortativity Coefficients","text":"can install linktree CRAN:","code":"install.packages(\"linktree\")"},{"path":"https://cygei.github.io/linktree/index.html","id":"definition","dir":"","previous_headings":"","what":"Definition","title":"Estimate Transmission Assortativity Coefficients","text":"Group transmission assortativity quantifies extent individuals transmit within group compared others. methodology described paper, briefly discussed YouTube. γ\\gamma coefficient ranges 0 ∞\\infty. describes excess propability transmitting within group versus groups. See get_gamma(). gamma assortativity coefficient can rescale γ\\gamma δ\\delta coefficient, ranges -1 1 using get_delta(). delta assortativity coefficient","code":""},{"path":"https://cygei.github.io/linktree/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Estimate Transmission Assortativity Coefficients","text":"linktree requires transmission chain data (.e. infected ) group membership individual transmission chain. information, check dedicated vignette.","code":""},{"path":"https://cygei.github.io/linktree/reference/check_alpha.html","id":null,"dir":"Reference","previous_headings":"","what":"Check 'alpha' value — check_alpha","title":"Check 'alpha' value — check_alpha","text":"Check 'alpha' value","code":""},{"path":"https://cygei.github.io/linktree/reference/check_alpha.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check 'alpha' value — check_alpha","text":"","code":"check_alpha(alpha)"},{"path":"https://cygei.github.io/linktree/reference/check_alpha.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check 'alpha' value — check_alpha","text":"alpha numeric value 0 1.","code":""},{"path":"https://cygei.github.io/linktree/reference/check_delta.html","id":null,"dir":"Reference","previous_headings":"","what":"Check 'delta' value — check_delta","title":"Check 'delta' value — check_delta","text":"Check 'delta' value","code":""},{"path":"https://cygei.github.io/linktree/reference/check_delta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check 'delta' value — check_delta","text":"","code":"check_delta(delta)"},{"path":"https://cygei.github.io/linktree/reference/check_delta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check 'delta' value — check_delta","text":"delta numeric vector -1 1.","code":""},{"path":"https://cygei.github.io/linktree/reference/check_flevels.html","id":null,"dir":"Reference","previous_headings":"","what":"Check 'f' levels — check_flevels","title":"Check 'f' levels — check_flevels","text":"Check 'f' levels","code":""},{"path":"https://cygei.github.io/linktree/reference/check_flevels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check 'f' levels — check_flevels","text":"","code":"check_flevels(f, levels)"},{"path":"https://cygei.github.io/linktree/reference/check_flevels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check 'f' levels — check_flevels","text":"f named numeric vector non-negative values. levels groups data.","code":""},{"path":"https://cygei.github.io/linktree/reference/check_fromto.html","id":null,"dir":"Reference","previous_headings":"","what":"Check 'from' and 'to' vectors — check_fromto","title":"Check 'from' and 'to' vectors — check_fromto","text":"Check '' '' vectors","code":""},{"path":"https://cygei.github.io/linktree/reference/check_fromto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check 'from' and 'to' vectors — check_fromto","text":"","code":"check_fromto(from, to)"},{"path":"https://cygei.github.io/linktree/reference/check_fromto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check 'from' and 'to' vectors — check_fromto","text":"vector infectors. vector infectees","code":""},{"path":"https://cygei.github.io/linktree/reference/check_gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Check 'gamma' value — check_gamma","title":"Check 'gamma' value — check_gamma","text":"Check 'gamma' value","code":""},{"path":"https://cygei.github.io/linktree/reference/check_gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check 'gamma' value — check_gamma","text":"","code":"check_gamma(gamma)"},{"path":"https://cygei.github.io/linktree/reference/check_gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check 'gamma' value — check_gamma","text":"gamma numeric vector non-negative values.","code":""},{"path":"https://cygei.github.io/linktree/reference/check_xn.html","id":null,"dir":"Reference","previous_headings":"","what":"Check 'x' and 'n' values — check_xn","title":"Check 'x' and 'n' values — check_xn","text":"Check 'x' 'n' values","code":""},{"path":"https://cygei.github.io/linktree/reference/check_xn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check 'x' and 'n' values — check_xn","text":"","code":"check_xn(x, n)"},{"path":"https://cygei.github.io/linktree/reference/check_xn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check 'x' and 'n' values — check_xn","text":"x Number successes. n Number trials.","code":""},{"path":"https://cygei.github.io/linktree/reference/delta2gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert delta to gamma — delta2gamma","title":"Convert delta to gamma — delta2gamma","text":"Convert delta gamma","code":""},{"path":"https://cygei.github.io/linktree/reference/delta2gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert delta to gamma — delta2gamma","text":"","code":"delta2gamma(delta)"},{"path":"https://cygei.github.io/linktree/reference/delta2gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert delta to gamma — delta2gamma","text":"delta numeric vector delta coefficients.","code":""},{"path":"https://cygei.github.io/linktree/reference/delta2gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert delta to gamma — delta2gamma","text":"numeric vector corresponding gamma coefficients.","code":""},{"path":"https://cygei.github.io/linktree/reference/delta2gamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert delta to gamma — delta2gamma","text":"","code":"delta2gamma(delta = c(-1,0,1)) #> [1]   0   1 Inf"},{"path":"https://cygei.github.io/linktree/reference/gamma2delta.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert gamma to delta — gamma2delta","title":"Convert gamma to delta — gamma2delta","text":"Convert gamma delta","code":""},{"path":"https://cygei.github.io/linktree/reference/gamma2delta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert gamma to delta — gamma2delta","text":"","code":"gamma2delta(gamma)"},{"path":"https://cygei.github.io/linktree/reference/gamma2delta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert gamma to delta — gamma2delta","text":"gamma numeric vector gamma coefficients.","code":""},{"path":"https://cygei.github.io/linktree/reference/gamma2delta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert gamma to delta — gamma2delta","text":"numeric vector delta coefficients.","code":""},{"path":"https://cygei.github.io/linktree/reference/gamma2delta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert gamma to delta — gamma2delta","text":"","code":"gamma2delta(gamma = c(0,1,10, Inf)) #> [1] -1.0000000  0.0000000  0.8181818  1.0000000"},{"path":"https://cygei.github.io/linktree/reference/get_delta.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate delta — get_delta","title":"Calculate delta — get_delta","text":"Computes scaled tansmission assortativity coefficient, see function gamma2delta.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_delta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate delta — get_delta","text":"","code":"get_delta(from, to, f, alpha = 0.05)"},{"path":"https://cygei.github.io/linktree/reference/get_delta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate delta — get_delta","text":"vector infectors. vector infectees. f named numeric value representing prevalence group population directly group sizes. alpha significance level confidence interval.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_delta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate delta — get_delta","text":"data frame estimated delta, lower upper confidence limits group.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_delta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate delta — get_delta","text":"","code":"from <- c(\"A\", \"A\", NA, \"C\", \"C\", \"C\") to <- c(\"A\", \"B\", \"B\", \"C\", \"C\", \"C\") f <- c(A = 0.3, B = 0.2, C = 0.5) get_delta(from, to, f, alpha = 0.05) #>   group est        lwr       upr #> 1     A 0.4 -0.9422658 0.9891398 #> 2     B NaN        NaN       NaN #> 3     C 1.0 -0.4151965 1.0000000"},{"path":"https://cygei.github.io/linktree/reference/get_gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate gamma — get_gamma","title":"Calculate gamma — get_gamma","text":"Computes tansmission assortativity coefficient defined excess probability secondary infection taking place within-group compared random expectations.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate gamma — get_gamma","text":"","code":"get_gamma(from, to, f, alpha = 0.05)"},{"path":"https://cygei.github.io/linktree/reference/get_gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate gamma — get_gamma","text":"vector infectors. vector infectees. f named numeric value representing prevalence group population directly group sizes. alpha significance level confidence interval.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate gamma — get_gamma","text":"data frame estimated gamma, lower upper confidence limits group.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_gamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate gamma — get_gamma","text":"","code":"from <- c(\"A\", \"A\", NA, \"C\", \"C\", \"C\") to <- c(\"A\", \"B\", \"B\", \"C\", \"C\", \"C\") f <- c(A = 0.3, B = 0.2, C = 0.5) get_gamma(from, to, f, alpha = 0.05) #>   group      est        lwr      upr #> 1     A 2.333333 0.02972519 183.1593 #> 2     B      NaN        NaN      NaN #> 3     C      Inf 0.41323136      Inf"},{"path":"https://cygei.github.io/linktree/reference/get_pi.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Pi Values — get_pi","title":"Calculate Pi Values — get_pi","text":"Calculates within-group transmission proportion 'pi' group data.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_pi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Pi Values — get_pi","text":"","code":"get_pi(from, to, alpha = 0.05)"},{"path":"https://cygei.github.io/linktree/reference/get_pi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Pi Values — get_pi","text":"vector infectors. vector infectees. alpha significance level confidence intervals.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_pi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Pi Values — get_pi","text":"data frame group names corresponding 'pi' values confidence intervals.","code":""},{"path":"https://cygei.github.io/linktree/reference/get_pi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Pi Values — get_pi","text":"","code":"from <- c(\"A\", \"A\", \"NA\", \"C\", \"C\", \"C\") to <- c(\"A\", \"B\", \"B\", \"C\", \"C\", \"C\") get_pi(from, to, alpha = 0.05) #>   group est        lwr       upr #> 1     A 0.5 0.01257912 0.9874209 #> 2     B NaN        NaN       NaN #> 3     C 1.0 0.29240177 1.0000000 #> 4    NA 0.0 0.00000000 0.9750000"},{"path":"https://cygei.github.io/linktree/reference/plot.linktree.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot linktree objects — plot.linktree","title":"Plot linktree objects — plot.linktree","text":"Plots error bars objects class linktree (subclasses gamma, delta, pi). method displays point estimates confidence intervals group. horizontal dotted line added neutral value: y = 1 subclass gamma y = 0 subclass delta.","code":""},{"path":"https://cygei.github.io/linktree/reference/plot.linktree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot linktree objects — plot.linktree","text":"","code":"# S3 method for class 'linktree' plot(x, ...)"},{"path":"https://cygei.github.io/linktree/reference/plot.linktree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot linktree objects — plot.linktree","text":"x object class linktree (subclasses gamma, delta, pi). ... Additional arguments passed base plot function.","code":""},{"path":"https://cygei.github.io/linktree/reference/plot.linktree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot linktree objects — plot.linktree","text":"return value, called side effects (produces plot).","code":""},{"path":"https://cygei.github.io/linktree/reference/plot.linktree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot linktree objects — plot.linktree","text":"","code":"from <- c(\"A\", \"A\", NA, \"C\", \"C\", \"C\") to <- c(\"A\", \"B\", \"B\", \"C\", \"C\", \"C\") f <- c(A = 0.3, B = 0.2, C = 0.5) plot(get_delta(from, to, f))  plot(get_gamma(from, to, f))"},{"path":"https://cygei.github.io/linktree/reference/sim_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated transmission tree — sim_tree","title":"Simulated transmission tree — sim_tree","text":"dataset represents simulated transmission tree. simulation generated using R package o2groups (see https://github.com/CyGei/o2groups information). Group HCW assortative gamma coefficient 2 group patient disassortative gamma coefficient 1/1.25. Suceptible group sizes 100 350, respectively. Code reproduce data :","code":"pak::pak(\"CyGei/o2groups\") set.seed(123) sim_tree <- o2groups::simulate_groups(   duration = 100,   group_n = 2,   size = c(100, 350), # susceptible group sizes   name = c(\"HCW\", \"patient\"),   gamma = c(2, 0.8), # assortativity coefficients   intro_n = c(1, 3),   r0 = c(2, 2),   generation_time = c(0, 0.1, 0.2, 0.4, 0.2, 0.1, 0),   incubation_period = sample(1:14, 1000, replace = TRUE) )"},{"path":"https://cygei.github.io/linktree/reference/sim_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated transmission tree — sim_tree","text":"","code":"sim_tree"},{"path":"https://cygei.github.io/linktree/reference/sim_tree.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated transmission tree — sim_tree","text":"data frame 373 rows 6 columns: group Character. group individual belongs. id Character. Unique identifier individual study. source Character. ID individual source infection, known. NA indicates unknown source. source_group Character. group source individual. NA unknown sources. date_infection Numeric. date infection. Represented number days since start study. date_onset Numeric. date onset symptoms. Represented number days since start study.","code":""},{"path":"https://cygei.github.io/linktree/reference/sim_tree.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simulated transmission tree — sim_tree","text":"dataset simulated (see R package o2groups) correspond real-world data.","code":""}]
